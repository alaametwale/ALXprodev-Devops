#!/bin/bash

OUTPUT_CSV="pokemon_report.csv"
echo "Name,Height (m),Weight (kg)" > $OUTPUT_CSV

TOTAL_HEIGHT=0
TOTAL_WEIGHT=0
COUNT=0

for FILE in pokemon_data/*.json; do
    NAME=$(jq -r '.name' $FILE | awk '{print toupper(substr($0,1,1)) substr($0,2)}')
    HEIGHT=$(jq -r '.height' $FILE)
    WEIGHT=$(jq -r '.weight' $FILE)
    echo "$NAME,$HEIGHT,$WEIGHT" >> $OUTPUT_CSV
    TOTAL_HEIGHT=$(echo "$TOTAL_HEIGHT + $HEIGHT" | bc)
    TOTAL_WEIGHT=$(echo "$TOTAL_WEIGHT + $WEIGHT" | bc)
    ((COUNT++))
done

AVG_HEIGHT=$(echo "scale=2; $TOTAL_HEIGHT / $COUNT" | bc)
AVG_WEIGHT=$(echo "scale=2; $TOTAL_WEIGHT / $COUNT" | bc)

echo ""
echo "CSV Report generated at: $OUTPUT_CSV"
echo ""
echo "Average Height: $AVG_HEIGHT m"
echo "Average Weight: $AVG_WEIGHT kg"
