#!/bin/bash

OUTPUT_CSV="pokemon_report.csv"
echo "Name,Height (m),Weight (kg)" > $OUTPUT_CSV

# استخراج البيانات لكل بوكيمون
for FILE in pokemon_data/*.json; do
    NAME=$(jq -r '.name' $FILE | sed 's/.*/\u&/')
    HEIGHT=$(jq -r '.height' $FILE)
    WEIGHT=$(jq -r '.weight' $FILE)
    echo "$NAME,$HEIGHT,$WEIGHT" >> $OUTPUT_CSV
done

# حساب المتوسط باستخدام awk
AVG_HEIGHT=$(awk -F, 'NR>1 {sum+=$2; count++} END {printf "%.2f", sum/count}' $OUTPUT_CSV)
AVG_WEIGHT=$(awk -F, 'NR>1 {sum+=$3; count++} END {printf "%.2f", sum/count}' $OUTPUT_CSV)

echo ""
echo "CSV Report generated at: $OUTPUT_CSV"
echo "Average Height: $AVG_HEIGHT m"
echo "Average Weight: $AVG_WEIGHT kg"
